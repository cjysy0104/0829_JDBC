package com.kh.run;

import java.sql.Connection;
import java.sql.Date;
import java.sql.DriverManager;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;

public class SelectRun {

	public static void main(String[] args) {

		// 0.
		Connection conn = null;
		Statement stat = null;
		ResultSet rset = null;

		// SQL Write
		String sql = null;
		sql = "SELECT * FROM EMPLOYEE" + " ORDER BY HIRE_DATE";

		try {
			// Driver
			Class.forName("oracle.jdbc.driver.OracleDriver");
			System.out.println("Driver OK");

			// Connection
			conn = DriverManager.getConnection("jdbc:oracle:thin:@115.90.212.20:10000:XE", "CJY19", "CJY191234");
			System.out.println("Connect OK");

			// Statement
			stat = conn.createStatement();
			System.out.println("Statement Obj OK");

			// SQL Active
			rset = stat.executeQuery(sql);
			System.out.println("ResultSet Return OK");

			// Print
			// EMP_ID, EMP_NAME, EMP_NO, EMAIL, PHONE, DEPT_CODE,
			// JOB_CODE, SAL_LEVEL, SALARY, BONUS, MANAGER_ID, HIRE_DATE
			while (rset.next()) {
				String empId = rset.getString("EMP_ID");
				String empName = rset.getString("EMP_NAME");
				String empNo = rset.getString("EMP_NO");
				String email = rset.getString("EMAIL");
				String phone = rset.getString("PHONE");
				String deptCode = rset.getString("DEPT_CODE");
				String jobCode = rset.getString("JOB_CODE");
				String salLevel = rset.getString("SAL_LEVEL");
				int Salary = rset.getInt("SALARY");
				double bonus = rset.getDouble("BONUS");
				String managerId = rset.getString("MANAGER_ID");
				Date hireDate = rset.getDate("HIRE_DATE");

				System.out.println(empId + empName + empNo + email + phone + deptCode + jobCode + salLevel + Salary
						+ bonus + managerId + hireDate);
			}

		} catch (ClassNotFoundException e) {
			e.printStackTrace();
		} catch (SQLException e) {
			e.printStackTrace();
		} finally {
			try {
				if (rset != null && !rset.isClosed()) {
					rset.close();
				}
			} catch (SQLException e) {
				e.printStackTrace();
			}

			try {
				if (stat != null && !stat.isClosed()) {
					stat.close();
				}
			} catch (SQLException e) {
				e.printStackTrace();
			}

			try {
				if (conn != null && !conn.isClosed()) {
					conn.close();
				}
			} catch (SQLException e) {
				e.printStackTrace();
			}
		}

	}

}
